



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
        <link rel="canonical" href="https://docs.pi-hole.net/guides/vpn/dual-operation/">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../../images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.0">
    
    
      
        <title>Optional: Dual operation: LAN & VPN at the same time - Pi-hole documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application.0284f74d.css">
      
      
    
    
      <script src="../../../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../../extra.css">
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#important-last-step" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://docs.pi-hole.net" title="Pi-hole documentation" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Pi-hole documentation
            </span>
            <span class="md-header-nav__topic">
              
                Optional: Dual operation: LAN & VPN at the same time
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/pi-hole/pi-hole/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://docs.pi-hole.net" title="Pi-hole documentation" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Pi-hole documentation
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/pi-hole/pi-hole/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../.." title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      About Pi-hole
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        About Pi-hole
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../main/contact/" title="Contact Us" class="md-nav__link">
      Contact Us
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../main/origins/" title="Pi-hole Origins" class="md-nav__link">
      Pi-hole Origins
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../main/presentations/" title="Presentation Support" class="md-nav__link">
      Presentation Support
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../main/coverage/" title="On the Web" class="md-nav__link">
      On the Web
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Getting Started
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Getting Started
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../main/prerequesites/" title="Prerequisites" class="md-nav__link">
      Prerequisites
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../main/basic-install/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../main/post-install/" title="Post-Install" class="md-nav__link">
      Post-Install
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../main/update/" title="Updating" class="md-nav__link">
      Updating
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Pi-hole Core
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Pi-hole Core
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../core/pihole-command/" title="The pihole command" class="md-nav__link">
      The <samp>pihole</samp> command
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      FTLDNS
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        FTLDNS
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ftldns/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ftldns/configfile/" title="Configuration" class="md-nav__link">
      Configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ftldns/dns-resolver/" title="DNS resolver" class="md-nav__link">
      DNS resolver
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ftldns/dns-cache/" title="DNS cache" class="md-nav__link">
      DNS cache
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ftldns/blockingmode/" title="Blocking mode" class="md-nav__link">
      Blocking mode
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-6" type="checkbox" id="nav-5-6">
    
    <label class="md-nav__link" for="nav-5-6">
      RegEx blocking
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-6">
        RegEx blocking
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ftldns/regex/overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ftldns/regex/tutorial/" title="Tutorial" class="md-nav__link">
      Tutorial
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ftldns/privacylevels/" title="Privacy levels" class="md-nav__link">
      Privacy levels
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ftldns/database/" title="Long-term database" class="md-nav__link">
      Long-term database
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ftldns/telnet-api/" title="Telnet API" class="md-nav__link">
      Telnet API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ftldns/compatibility/" title="Compatibility" class="md-nav__link">
      Compatibility
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ftldns/compile/" title="Install from source" class="md-nav__link">
      Install from source
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ftldns/debugging/" title="Debugging FTLDNS" class="md-nav__link">
      Debugging FTLDNS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ftldns/in-depth/" title="In-depth manual" class="md-nav__link">
      In-depth manual
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Docker
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Docker
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../docker/DHCP/" title="DHCP" class="md-nav__link">
      DHCP
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Contributing
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Contributing
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../github/contributing/" title="Contributing on Github" class="md-nav__link">
      Contributing on Github
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../github/how-to-signoff/" title="How to sign-off commits" class="md-nav__link">
      How to sign-off commits
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8" checked>
    
    <label class="md-nav__link" for="nav-8">
      Guides
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        Guides
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../unbound/" title="Pi-hole as All-Around DNS Solution" class="md-nav__link">
      Pi-hole as All-Around DNS Solution
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../dns-over-https/" title="Configuring DNS-Over-HTTPS on Pi-hole" class="md-nav__link">
      Configuring DNS-Over-HTTPS on Pi-hole
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../upstream-dns-providers/" title="Upstream DNS Providers" class="md-nav__link">
      Upstream DNS Providers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../whitelist-blacklist/" title="Editing Whitelist and Blacklist" class="md-nav__link">
      Editing Whitelist and Blacklist
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../nginx-configuration/" title="Configuring NGINX for Pi-hole" class="md-nav__link">
      Configuring NGINX for Pi-hole
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../caddy-configuration/" title="Configuring Caddy for Pi-hole" class="md-nav__link">
      Configuring Caddy for Pi-hole
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../traefik-configuration-nodocker/" title="Configuring Traefik for Pi-hole (not in Docker)" class="md-nav__link">
      Configuring Traefik for Pi-hole (not in Docker)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../benchmark/" title="Benchmarking" class="md-nav__link">
      Benchmarking
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-9" type="checkbox" id="nav-8-9" checked>
    
    <label class="md-nav__link" for="nav-8-9">
      Pi-hole and OpenVPN Server
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-9">
        Pi-hole and OpenVPN Server
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../installation/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../setup-openvpn-server/" title="Setup OpenVPN Server" class="md-nav__link">
      Setup OpenVPN Server
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../firewall/" title="Firewall Configuration" class="md-nav__link">
      Firewall Configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-9-5" type="checkbox" id="nav-8-9-5">
    
    <label class="md-nav__link" for="nav-8-9-5">
      Connecting clients
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-9-5">
        Connecting clients
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../clients/" title="General" class="md-nav__link">
      General
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../android-client/" title="Android" class="md-nav__link">
      Android
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../only-dns-via-vpn/" title="Optional: Only route DNS via VPN" class="md-nav__link">
      Optional: Only route DNS via VPN
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Optional: Dual operation: LAN & VPN at the same time
      </label>
    
    <a href="./" title="Optional: Dual operation: LAN & VPN at the same time" class="md-nav__link md-nav__link--active">
      Optional: Dual operation: LAN & VPN at the same time
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#important-last-step" title="Important last step" class="md-nav__link">
    Important last step
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dual-VPN/" title="Optional: Full and DNS-only" class="md-nav__link">
      Optional: Full and DNS-only
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dynDNS/" title="Optional: Dynamic DNS" class="md-nav__link">
      Optional: Dynamic DNS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../troubleshooting/" title="Troubleshooting" class="md-nav__link">
      Troubleshooting
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-10" type="checkbox" id="nav-8-10">
    
    <label class="md-nav__link" for="nav-8-10">
      TOR & Pi-hole
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-10">
        TOR & Pi-hole
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tor/overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tor/setup/" title="Basic Setup" class="md-nav__link">
      Basic Setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tor/using-tor/" title="Using TOR" class="md-nav__link">
      Using TOR
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tor/performance-issues/" title="Performance and other issues" class="md-nav__link">
      Performance and other issues
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tor/dnssec/" title="Using DNSSEC" class="md-nav__link">
      Using DNSSEC
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../main/projects/" title="Community Projects" class="md-nav__link">
      Community Projects
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#important-last-step" title="Important last step" class="md-nav__link">
    Important last step
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Optional: Dual operation: LAN & VPN at the same time</h1>
                
                <p><strong>Up until now, this wiki has been about a server set up on a cloud host, available on the public Internet.  This section is aimed at a server setup in a private network like on a Raspberry Pi.</strong></p>
<p>So if blocking works using <code>eth0</code> but stops working for <code>tun0</code>, as described <a href="https://github.com/pi-hole/pi-hole/issues/1553">here</a>, you may want to run this command <code>pihole -a -i all</code>, which should get the behaviour you want by opening dnsmasq up to listen on all ports. This is not recommended for cloud servers as they should <em>not</em> be listening on <code>eth0</code>.</p>
<p>If you want to set up your Pi-hole + OpenVPN such that you can use from both internal ((W)LAN) and external (VPN) networks, you have to apply some small changes. As additional benefit, you will be able to reach all devices in the internal network (e.g. computers, networking-aware printers, etc.) through the VPN.</p>
<p>This setup assumes that your local network is in the range <strong>192.168.2.0</strong> (i.e. device addresses are in the range of 192.168.2.1 - 192.168.2.254). If this is not the case for you, you have to adjust the settings, accordingly, e.g.</p>
<ul>
<li>devices in 192.168.0.1 - 192.168.0.254 -&gt; <code>route 192.168.0.0</code></li>
<li>devices in 192.168.123.1 - 192.168.123.254 -&gt; <code>route 192.168.123.0</code></li>
</ul>
<p>Edit your <code>/etc/openvpn/server.conf</code>:</p>
<div class="codehilite"><pre><span></span><span class="n">push</span> <span class="ss">&quot;route 192.168.2.0 255.255.255.0&quot;</span>
<span class="n">push</span> <span class="ss">&quot;dhcp-option DNS 192.168.2.123&quot;</span>
</pre></div>

<p>As you can see, we change the address of the DNS server to the local IP address of our Pi-hole (which is <strong>192.168.2.123</strong> in this example).</p>
<p>Afterwards, we change the interface of <code>Pi-hole</code> to <code>eth0</code> (your local network adapter instead of the VPN adapter <code>tun0</code>). This can conveniently be done by using <code>pihole -r</code> + <code>Reconfigure</code>.</p>
<p>After a restart of the OpenVPN server, all clients should be able to see all devices within your (at home) local network. This is an example running on a distant server, which is connected through the VPN and can successfully communicate with all internal devices:</p>
<div class="codehilite"><pre><span></span><span class="n">me</span><span class="nv">@client</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="err">$</span><span class="w"> </span><span class="n">ifconfig</span><span class="w"></span>
<span class="n">eth0</span><span class="w">      </span><span class="n">Link</span><span class="w"> </span><span class="nl">encap</span><span class="p">:</span><span class="n">Ethernet</span><span class="w">  </span><span class="n">HWaddr</span><span class="w"> </span><span class="nl">e0</span><span class="p">:</span><span class="nl">xx</span><span class="p">:</span><span class="nl">xx</span><span class="p">:</span><span class="nl">xx</span><span class="p">:</span><span class="nl">xx</span><span class="p">:</span><span class="n">xx</span><span class="w">  </span>
<span class="w">          </span><span class="n">inet</span><span class="w"> </span><span class="nl">addr</span><span class="p">:</span><span class="mf">134.</span><span class="n">x</span><span class="p">.</span><span class="n">x</span><span class="p">.</span><span class="n">x</span><span class="w">  </span><span class="nl">Bcast</span><span class="p">:</span><span class="mf">134.</span><span class="n">x</span><span class="p">.</span><span class="n">x</span><span class="p">.</span><span class="n">x</span><span class="w">  </span><span class="nl">Mask</span><span class="p">:</span><span class="mf">255.</span><span class="n">x</span><span class="p">.</span><span class="n">x</span><span class="p">.</span><span class="n">x</span><span class="w"></span>
<span class="w">          </span><span class="n">inet6</span><span class="w"> </span><span class="nl">addr</span><span class="p">:</span><span class="w"> </span><span class="nl">X</span><span class="p">:</span><span class="nl">X</span><span class="p">:</span><span class="nl">X</span><span class="p">:</span><span class="nl">X</span><span class="p">:</span><span class="err">:</span><span class="n">X</span><span class="o">/</span><span class="mi">64</span><span class="w"> </span><span class="k">Scope</span><span class="err">:</span><span class="n">Link</span><span class="w"></span>
<span class="w">          </span><span class="n">UP</span><span class="w"> </span><span class="n">BROADCAST</span><span class="w"> </span><span class="n">RUNNING</span><span class="w"> </span><span class="n">MULTICAST</span><span class="w">  </span><span class="nl">MTU</span><span class="p">:</span><span class="mi">1500</span><span class="w">  </span><span class="nl">Metric</span><span class="p">:</span><span class="mi">1</span><span class="w"></span>
<span class="w">          </span><span class="n">RX</span><span class="w"> </span><span class="nl">packets</span><span class="p">:</span><span class="mi">3623911</span><span class="w"> </span><span class="nl">errors</span><span class="p">:</span><span class="mi">0</span><span class="w"> </span><span class="nl">dropped</span><span class="p">:</span><span class="mi">0</span><span class="w"> </span><span class="nl">overruns</span><span class="p">:</span><span class="mi">0</span><span class="w"> </span><span class="nl">frame</span><span class="p">:</span><span class="mi">0</span><span class="w"></span>
<span class="w">          </span><span class="n">TX</span><span class="w"> </span><span class="nl">packets</span><span class="p">:</span><span class="mi">2803670</span><span class="w"> </span><span class="nl">errors</span><span class="p">:</span><span class="mi">0</span><span class="w"> </span><span class="nl">dropped</span><span class="p">:</span><span class="mi">0</span><span class="w"> </span><span class="nl">overruns</span><span class="p">:</span><span class="mi">0</span><span class="w"> </span><span class="nl">carrier</span><span class="p">:</span><span class="mi">0</span><span class="w"></span>
<span class="w">          </span><span class="nl">collisions</span><span class="p">:</span><span class="mi">0</span><span class="w"> </span><span class="nl">txqueuelen</span><span class="p">:</span><span class="mi">1000</span><span class="w"> </span>
<span class="w">          </span><span class="n">RX</span><span class="w"> </span><span class="nl">bytes</span><span class="p">:</span><span class="mi">1921375471</span><span class="w"> </span><span class="p">(</span><span class="mf">1.9</span><span class="w"> </span><span class="n">GB</span><span class="p">)</span><span class="w">  </span><span class="n">TX</span><span class="w"> </span><span class="nl">bytes</span><span class="p">:</span><span class="mi">1227835028</span><span class="w"> </span><span class="p">(</span><span class="mf">1.2</span><span class="w"> </span><span class="n">GB</span><span class="p">)</span><span class="w"></span>

<span class="n">lo</span><span class="w">        </span><span class="n">Link</span><span class="w"> </span><span class="nl">encap</span><span class="p">:</span><span class="k">Local</span><span class="w"> </span><span class="n">Loopback</span><span class="w">  </span>
<span class="w">          </span><span class="n">inet</span><span class="w"> </span><span class="nl">addr</span><span class="p">:</span><span class="mf">127.0.0.1</span><span class="w">  </span><span class="nl">Mask</span><span class="p">:</span><span class="mf">255.0.0.0</span><span class="w"></span>
<span class="w">          </span><span class="n">inet6</span><span class="w"> </span><span class="nl">addr</span><span class="p">:</span><span class="w"> </span><span class="o">::</span><span class="mi">1</span><span class="o">/</span><span class="mi">128</span><span class="w"> </span><span class="k">Scope</span><span class="err">:</span><span class="k">Host</span><span class="w"></span>
<span class="w">          </span><span class="n">UP</span><span class="w"> </span><span class="n">LOOPBACK</span><span class="w"> </span><span class="n">RUNNING</span><span class="w">  </span><span class="nl">MTU</span><span class="p">:</span><span class="mi">65536</span><span class="w">  </span><span class="nl">Metric</span><span class="p">:</span><span class="mi">1</span><span class="w"></span>
<span class="w">          </span><span class="n">RX</span><span class="w"> </span><span class="nl">packets</span><span class="p">:</span><span class="mi">553426</span><span class="w"> </span><span class="nl">errors</span><span class="p">:</span><span class="mi">0</span><span class="w"> </span><span class="nl">dropped</span><span class="p">:</span><span class="mi">0</span><span class="w"> </span><span class="nl">overruns</span><span class="p">:</span><span class="mi">0</span><span class="w"> </span><span class="nl">frame</span><span class="p">:</span><span class="mi">0</span><span class="w"></span>
<span class="w">          </span><span class="n">TX</span><span class="w"> </span><span class="nl">packets</span><span class="p">:</span><span class="mi">553426</span><span class="w"> </span><span class="nl">errors</span><span class="p">:</span><span class="mi">0</span><span class="w"> </span><span class="nl">dropped</span><span class="p">:</span><span class="mi">0</span><span class="w"> </span><span class="nl">overruns</span><span class="p">:</span><span class="mi">0</span><span class="w"> </span><span class="nl">carrier</span><span class="p">:</span><span class="mi">0</span><span class="w"></span>
<span class="w">          </span><span class="nl">collisions</span><span class="p">:</span><span class="mi">0</span><span class="w"> </span><span class="nl">txqueuelen</span><span class="p">:</span><span class="mi">1</span><span class="w"> </span>
<span class="w">          </span><span class="n">RX</span><span class="w"> </span><span class="nl">bytes</span><span class="p">:</span><span class="mi">113417383</span><span class="w"> </span><span class="p">(</span><span class="mf">113.4</span><span class="w"> </span><span class="n">MB</span><span class="p">)</span><span class="w">  </span><span class="n">TX</span><span class="w"> </span><span class="nl">bytes</span><span class="p">:</span><span class="mi">113417383</span><span class="w"> </span><span class="p">(</span><span class="mf">113.4</span><span class="w"> </span><span class="n">MB</span><span class="p">)</span><span class="w"></span>

<span class="n">tun0</span><span class="w">      </span><span class="n">Link</span><span class="w"> </span><span class="nl">encap</span><span class="p">:</span><span class="n">UNSPEC</span><span class="w">  </span><span class="n">HWaddr</span><span class="w"> </span><span class="mi">00</span><span class="o">-</span><span class="mi">00</span><span class="o">-</span><span class="mi">00</span><span class="o">-</span><span class="mi">00</span><span class="o">-</span><span class="mi">00</span><span class="o">-</span><span class="mi">00</span><span class="o">-</span><span class="mi">00</span><span class="o">-</span><span class="mi">00</span><span class="o">-</span><span class="mi">00</span><span class="o">-</span><span class="mi">00</span><span class="o">-</span><span class="mi">00</span><span class="o">-</span><span class="mi">00</span><span class="o">-</span><span class="mi">00</span><span class="o">-</span><span class="mi">00</span><span class="o">-</span><span class="mi">00</span><span class="o">-</span><span class="mi">00</span><span class="w">  </span>
<span class="w">          </span><span class="n">inet</span><span class="w"> </span><span class="nl">addr</span><span class="p">:</span><span class="mf">10.8.0.2</span><span class="w">  </span><span class="n">P</span><span class="o">-</span><span class="n">t</span><span class="o">-</span><span class="nl">P</span><span class="p">:</span><span class="mf">10.8.0.2</span><span class="w">  </span><span class="nl">Mask</span><span class="p">:</span><span class="mf">255.255.255.0</span><span class="w"></span>
<span class="w">          </span><span class="n">UP</span><span class="w"> </span><span class="n">POINTOPOINT</span><span class="w"> </span><span class="n">RUNNING</span><span class="w"> </span><span class="n">NOARP</span><span class="w"> </span><span class="n">MULTICAST</span><span class="w">  </span><span class="nl">MTU</span><span class="p">:</span><span class="mi">1500</span><span class="w">  </span><span class="nl">Metric</span><span class="p">:</span><span class="mi">1</span><span class="w"></span>
<span class="w">          </span><span class="n">RX</span><span class="w"> </span><span class="nl">packets</span><span class="p">:</span><span class="mi">274676</span><span class="w"> </span><span class="nl">errors</span><span class="p">:</span><span class="mi">0</span><span class="w"> </span><span class="nl">dropped</span><span class="p">:</span><span class="mi">0</span><span class="w"> </span><span class="nl">overruns</span><span class="p">:</span><span class="mi">0</span><span class="w"> </span><span class="nl">frame</span><span class="p">:</span><span class="mi">0</span><span class="w"></span>
<span class="w">          </span><span class="n">TX</span><span class="w"> </span><span class="nl">packets</span><span class="p">:</span><span class="mi">331178</span><span class="w"> </span><span class="nl">errors</span><span class="p">:</span><span class="mi">0</span><span class="w"> </span><span class="nl">dropped</span><span class="p">:</span><span class="mi">0</span><span class="w"> </span><span class="nl">overruns</span><span class="p">:</span><span class="mi">0</span><span class="w"> </span><span class="nl">carrier</span><span class="p">:</span><span class="mi">0</span><span class="w"></span>
<span class="w">          </span><span class="nl">collisions</span><span class="p">:</span><span class="mi">0</span><span class="w"> </span><span class="nl">txqueuelen</span><span class="p">:</span><span class="mi">100</span><span class="w"> </span>
<span class="w">          </span><span class="n">RX</span><span class="w"> </span><span class="nl">bytes</span><span class="p">:</span><span class="mi">43745313</span><span class="w"> </span><span class="p">(</span><span class="mf">43.7</span><span class="w"> </span><span class="n">MB</span><span class="p">)</span><span class="w">  </span><span class="n">TX</span><span class="w"> </span><span class="nl">bytes</span><span class="p">:</span><span class="mi">43956250</span><span class="w"> </span><span class="p">(</span><span class="mf">43.9</span><span class="w"> </span><span class="n">MB</span><span class="p">)</span><span class="w"></span>

<span class="n">me</span><span class="nv">@client</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="err">$</span><span class="w"> </span><span class="n">ping</span><span class="w"> </span><span class="mf">192.168.2.123</span><span class="w"></span>
<span class="n">PING</span><span class="w"> </span><span class="mf">192.168.2.123</span><span class="w"> </span><span class="p">(</span><span class="mf">192.168.2.123</span><span class="p">)</span><span class="w"> </span><span class="mi">56</span><span class="p">(</span><span class="mi">84</span><span class="p">)</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">data</span><span class="p">.</span><span class="w"></span>
<span class="mi">64</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mf">192.168.2.123</span><span class="err">:</span><span class="w"> </span><span class="n">icmp_seq</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="n">ttl</span><span class="o">=</span><span class="mi">64</span><span class="w"> </span><span class="nc">time</span><span class="o">=</span><span class="mf">18.9</span><span class="w"> </span><span class="n">ms</span><span class="w"></span>
<span class="mi">64</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mf">192.168.2.123</span><span class="err">:</span><span class="w"> </span><span class="n">icmp_seq</span><span class="o">=</span><span class="mi">2</span><span class="w"> </span><span class="n">ttl</span><span class="o">=</span><span class="mi">64</span><span class="w"> </span><span class="nc">time</span><span class="o">=</span><span class="mf">18.9</span><span class="w"> </span><span class="n">ms</span><span class="w"></span>
<span class="mi">64</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mf">192.168.2.123</span><span class="err">:</span><span class="w"> </span><span class="n">icmp_seq</span><span class="o">=</span><span class="mi">3</span><span class="w"> </span><span class="n">ttl</span><span class="o">=</span><span class="mi">64</span><span class="w"> </span><span class="nc">time</span><span class="o">=</span><span class="mf">18.9</span><span class="w"> </span><span class="n">ms</span><span class="w"></span>
<span class="mi">64</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mf">192.168.2.123</span><span class="err">:</span><span class="w"> </span><span class="n">icmp_seq</span><span class="o">=</span><span class="mi">4</span><span class="w"> </span><span class="n">ttl</span><span class="o">=</span><span class="mi">64</span><span class="w"> </span><span class="nc">time</span><span class="o">=</span><span class="mf">18.7</span><span class="w"> </span><span class="n">ms</span><span class="w"></span>
<span class="mi">64</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mf">192.168.2.123</span><span class="err">:</span><span class="w"> </span><span class="n">icmp_seq</span><span class="o">=</span><span class="mi">5</span><span class="w"> </span><span class="n">ttl</span><span class="o">=</span><span class="mi">64</span><span class="w"> </span><span class="nc">time</span><span class="o">=</span><span class="mf">18.7</span><span class="w"> </span><span class="n">ms</span><span class="w"></span>
<span class="mi">64</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mf">192.168.2.123</span><span class="err">:</span><span class="w"> </span><span class="n">icmp_seq</span><span class="o">=</span><span class="mi">6</span><span class="w"> </span><span class="n">ttl</span><span class="o">=</span><span class="mi">64</span><span class="w"> </span><span class="nc">time</span><span class="o">=</span><span class="mf">19.0</span><span class="w"> </span><span class="n">ms</span><span class="w"></span>
<span class="o">^</span><span class="n">C</span><span class="w"></span>
<span class="c1">--- 192.168.2.123 ping statistics ---</span>
<span class="mi">6</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">transmitted</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="n">received</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="o">%</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">loss</span><span class="p">,</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="mi">5007</span><span class="n">ms</span><span class="w"></span>
<span class="n">rtt</span><span class="w"> </span><span class="nf">min</span><span class="o">/</span><span class="nf">avg</span><span class="o">/</span><span class="nf">max</span><span class="o">/</span><span class="n">mdev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">18.740</span><span class="o">/</span><span class="mf">18.894</span><span class="o">/</span><span class="mf">19.017</span><span class="o">/</span><span class="mf">0.189</span><span class="w"> </span><span class="n">ms</span><span class="w"></span>
</pre></div>

<h3 id="important-last-step">Important last step<a class="headerlink" href="#important-last-step" title="Permanent link">&para;</a></h3>
<p>The undocumented <code>pihole -a -i all</code> command is simply what runs when you choose <em>Listen on all interfaces, permit all origins (make sure your Pi-hole is firewalled)</em>, which if you've read this far in the tutorial, you should understand that we don't want you to knowingly or unknowing set up an open resolver.
<img alt="screenshot" src="../listening-behavior.png" /></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../only-dns-via-vpn/" title="Optional: Only route DNS via VPN" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Optional: Only route DNS via VPN
              </span>
            </div>
          </a>
        
        
          <a href="../dual-VPN/" title="Optional: Full and DNS-only" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Optional: Full and DNS-only
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2018 Pi-hole LLC
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../../assets/fonts/font-awesome.css">
    
      <a href="https://pi-hole.net" class="md-footer-social__link fa fa-globe"></a>
    
      <a href="https://github.com/pi-hole" class="md-footer-social__link fa fa-github-alt"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application.245445c6.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../../.."}})</script>
      
    
  </body>
</html>